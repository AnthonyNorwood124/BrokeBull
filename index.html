<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BrokeBull — Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase Compat -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-functions-compat.js"></script>
  <script src="firebase.js"></script>
</head>

<body>
  <!-- Keep your hero style; just adding CTAs -->
  <header class="hero">
    <div class="hero-bar">
      <img class="logo logo--xl" src="images/logo.jpg" alt="BrokeBull" />
      <h1>Welcome to BrokeBull</h1>

      <!-- Role-aware CTAs -->
      <div id="planCtas" class="auth-links">
        <a class="btn btn-primary" href="basic.html" id="ctaBasic" style="display:none;">Go to Basic</a>
        <a class="btn" href="pro.html" id="ctaPro" style="display:none;">Go to Pro</a>
        <a class="btn" href="login.html" id="ctaLogin" style="display:none;">Log In</a>
        <button class="btn" id="ctaLogout" style="display:none;" onclick="logout()">Logout</button>
      </div>
    </div>
  </header>

  <!-- Keep your landing sections; sample structure below matches style.css -->
  <main>
    <section class="what-we-do">
      <div class="container">
        <h2>What we do</h2>
        <p>Actionable market context, clean charts, and a pragmatic playbook for retail investors.</p>
      </div>
    </section>

    <section class="pricing">
      <div class="container">
        <h2>Plans</h2>
        <div class="card-container">
          <article class="card">
            <h3>Basic</h3>
            <ul>
              <li>Market overview & news</li>
              <li>Economic calendar</li>
              <li>Symbol snapshots</li>
            </ul>
            <a class="btn" href="basic.html">Go to Basic</a>
          </article>

          <article class="card">
            <h3>Pro</h3>
            <ul>
              <li>Advanced charting & screener</li>
              <li>Stage-2 algo watchlist</li>
              <li>Founder Q&amp;A</li>
            </ul>
            <a class="btn" href="pro.html">Go to Pro</a>
          </article>
        </div>
      </div>
    </section>

    <section class="testimonials">
      <div class="container">
        <h2>What traders say</h2>
        <div class="testimonial-row">
          <div class="testimonial"><p>“Dashboard clarity without the noise.”</p></div>
          <div class="testimonial"><p>“Signals that respect risk.”</p></div>
          <div class="testimonial"><p>“Clean UX, sane defaults.”</p></div>
        </div>
      </div>
    </section>

    <section class="founder">
      <div class="container founder-bio">
        <img src="images/logo.jpg" alt="BrokeBull" class="founder-photo" />
        <h2>Why BrokeBull?</h2>
        <p>We make disciplined trading feel simple. Tools that get out of your way, and a cadence that keeps you in the pocket.</p>
      </div>
    </section>
  </main>

  <!-- CTA logic (auth/role-aware; landing visuals untouched) -->
  <script>
  (function initLandingCTAs(){
    if (!window.firebase || !firebase.apps?.length) { // static fail-safe
      document.getElementById('ctaBasic').style.display = '';
      document.getElementById('ctaPro').style.display = '';
      document.getElementById('ctaLogin').style.display = '';
      return;
    }
    const auth = firebase.auth();
    const db   = firebase.firestore();

    const $ = id => document.getElementById(id);
    const show = el => el && (el.style.display = "");
    const hide = el => el && (el.style.display = "none");

    auth.onAuthStateChanged(async user => {
      show($("ctaBasic")); show($("ctaPro")); // always visible
      if (!user) { show($("ctaLogin")); hide($("ctaLogout")); $("ctaPro").textContent = "Go to Pro"; return; }

      hide($("ctaLogin")); show($("ctaLogout"));
      try {
        const snap = await db.collection('users').doc(user.uid).get();
        const role = snap.exists && snap.data().role ? snap.data().role : 'basic';
        $("ctaPro").textContent = role === 'pro' ? "Go to Pro" : "Upgrade to Pro";
      } catch(e) {
        console.warn("Role check failed:", e);
        $("ctaPro").textContent = "Go to Pro";
      }
    });
  })();
  </script>
</body>
</html>
