<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Broke Bull Investments</title>

  <!-- Site styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase Compat SDKs (match firebase.js usage) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-functions-compat.js"></script>

  <!-- Your Firebase config/logic (must be after SDKs) -->
  <script src="firebase.js"></script>
</head>

<body>
  <!-- HERO -->
  <header class="hero">
    <div class="container hero-bar">
      <!-- centered + larger logo -->
      <img class="logo logo--xl" src="images/logo.jpg" alt="BrokeBull logo">

      <!-- Auth + plan CTAs (role-aware) -->
      <nav class="auth-links" id="heroCtas">
        <a class="btn btn-primary" href="basic.html" id="ctaBasic" style="display:none;">Go to Basic</a>
        <a class="btn" href="pro.html" id="ctaPro" style="display:none;">Go to Pro ($19/mo)</a>

        <!-- Auth navigates to on-page form (#auth) to keep auth on landing -->
        <a class="btn btn-outline" href="#auth" id="ctaLogin" style="display:none;">Login</a>
        <a class="btn btn-outline" href="#auth" id="ctaCreate" style="display:none;">Create Account</a>
        <button class="btn" id="ctaLogout" style="display:none;">Logout</button>
      </nav>
    </div>

    <h1>Brick by Brick</h1>
    <p class="subtitle">Join Now for Market Winners</p>
  </header>

  <!-- WHAT WE DO (keeps your candles vibe) -->
  <section class="what-we-do" style="background-image:url('images/candlesticks.png'); background-size:cover; background-repeat:no-repeat;">
    <div class="container">
      <h2>What We Do</h2>
      <p>
        We identify high-potential stocks in Stage 2 using a proprietary algorithm. Our platform empowers long-term investors with
        institutional-grade analysis and weekly insights.
      </p>
    </div>
  </section>

  <!-- PRICING -->
  <section class="pricing">
    <div class="container">
      <h2>Pricing</h2>
      <div class="card-container">
        <article class="card">
          <h3>Free</h3>
          <ul>
            <li>Limited Watchlist Access</li>
            <li>Basic Newsletter</li>
          </ul>
          <a href="https://newsletter.brokebullinvestments.com/subscribe" class="btn" target="_blank" rel="noopener">Join Free</a>
        </article>

        <article class="card">
          <h3>Pro — $19/month</h3>
          <ul>
            <li>Full Watchlist Access</li>
            <li>Daily Market Insights</li>
            <li>Pro Newsletter</li>
          </ul>
          <!-- If upgradePro() exists, use it; otherwise go to pro.html -->
          <a href="#" class="btn" id="joinProBtn">Join Pro ($19/mo)</a>
        </article>
      </div>
    </div>
  </section>

  <!-- TESTIMONIALS -->
  <section class="testimonials">
    <div class="container">
      <h2>Testimonials</h2>
      <div class="testimonial-row">
        <div class="testimonial"><img src="images/testimonial1.png" alt="Mike"/><p>“Best investment insights I’ve ever received.” – Mike</p></div>
        <div class="testimonial"><img src="images/testimonial2.png" alt="Marcus"/><p>“The algo nailed 3 big moves in a row.” – Marcus</p></div>
        <div class="testimonial"><img src="images/testimonial3.png" alt="LaToya"/><p>“I’m finally confident in my stock picks.” – LaToya</p></div>
        <div class="testimonial"><img src="images/testimonial4.png" alt="Chris"/><p>“The Pro tier is worth every dollar.” – Chris</p></div>
        <div class="testimonial"><img src="images/testimonial5.png" alt="Janine"/><p>“Strong results, solid support.” – Janine</p></div>
      </div>
    </div>
  </section>

  <!-- FOUNDER -->
  <section class="founder">
    <div class="container founder-bio">
      <h2>Founder</h2>
      <img src="founder.jpg" class="founder-photo" alt="Founder Photo" />
      <p>
        Anthony Norwood is a veteran and long-term investor who brings strategic insight and institutional-grade analysis to
        BrokeBull Investments. A retired 21-year Army Veteran (Chief Warrant Officer 3) as a Targateer, his mission is to simplify market
        success for everyday investors—brick by brick.
      </p>
    </div>
  </section>

  <!-- EMBEDDED AUTH (Sign Up / Sign In on the landing page) -->
  <section id="auth" class="auth-section">
    <div class="container">
      <h2>Create Account or Sign In</h2>
      <div class="auth-row" style="display:flex;gap:10px;flex-wrap:wrap;">
        <input id="email" type="email" placeholder="email@domain.com" autocomplete="username" />
        <input id="password" type="password" placeholder="Password" autocomplete="current-password" />
        <button id="createBtn" type="button" class="btn btn-primary">Create Account</button>
        <button id="signInBtn" type="button" class="btn btn-outline">Sign In</button>
      </div>
      <div class="auth-helpers" style="margin-top:8px;">
        <a href="#" id="resetLink">Forgot password?</a>
        <span id="status" class="auth-status" style="margin-left:10px;opacity:.9;"></span>
      </div>
    </div>
  </section>

  <!-- Landing-page logic: role-aware CTAs + embedded auth handlers -->
  <script>
    (function initLanding(){
      const hasFirebase = !!(window.firebase && firebase.apps && firebase.apps.length);
      const $ = id => document.getElementById(id);
      const show = el => el && (el.style.display = "");
      const hide = el => el && (el.style.display = "none");
      const setText = (el, txt) => el && (el.textContent = txt);

      // Fallback logout if not provided by firebase.js
      const doLogout = async () => {
        try { 
          if (typeof window.logout === 'function') return window.logout();
          if (hasFirebase) await firebase.auth().signOut();
        } catch(e){ console.warn('Logout failed', e); }
      };

      // Wire logout button
      $("ctaLogout").addEventListener("click", (e) => { e.preventDefault(); doLogout(); });

      // Join Pro button: prefer upgradePro(); fallback to pro.html
      $("joinProBtn").addEventListener("click", (e) => {
        e.preventDefault();
        if (typeof window.upgradePro === "function") { window.upgradePro(); }
        else { window.location.href = "pro.html"; }
      });

      // Auth UI handlers (landing-only auth)
      if (hasFirebase) {
        const auth = firebase.auth();
        const db   = firebase.firestore();

        const setStatus = (msg, ok=false) => {
          const s = $("status");
          if (!s) return;
          s.textContent = msg;
          s.style.color = ok ? "#9be28c" : "#ffd6d6";
        };

        const readInputs = () => ({
          email: ($("email")?.value || "").trim(),
          password: $("password")?.value || ""
        });

        $("createBtn").addEventListener("click", async () => {
          const {email, password} = readInputs();
          try {
            await auth.createUserWithEmailAndPassword(email, password);
            setStatus("Account created. You’re signed in.", true);
          } catch (e) {
            setStatus(e.message || "Sign-up failed");
          }
        });

        $("signInBtn").addEventListener("click", async () => {
          const {email, password} = readInputs();
          try {
            await auth.signInWithEmailAndPassword(email, password);
            setStatus("Signed in.", true);
          } catch (e) {
            setStatus(e.message || "Sign-in failed");
          }
        });

        $("resetLink").addEventListener("click", async (e) => {
          e.preventDefault();
          const email = ($("email")?.value || "").trim();
          if (!email) { setStatus("Enter your email first to reset."); return; }
          try {
            await auth.sendPasswordResetEmail(email);
            setStatus("Password reset email sent.", true);
          } catch (e) {
            setStatus(e.message || "Couldn’t send reset email");
          }
        });

        // Role-aware CTAs
        auth.onAuthStateChanged(async (user) => {
          // Always expose plan entry points
          show($("ctaBasic"));
          show($("ctaPro"));

          if (!user) {
            // Signed out
            show($("ctaLogin"));
            show($("ctaCreate"));
            hide($("ctaLogout"));
            setText($("ctaPro"), "Go to Pro ($19/mo)");
            return;
          }

          // Signed in
          hide($("ctaLogin"));
          hide($("ctaCreate"));
          show($("ctaLogout"));

          try {
            const snap = await db.collection('users').doc(user.uid).get();
            const role = snap.exists && snap.data().role ? snap.data().role : 'basic';
            // Labeling: pro sees "Go to Pro", everyone else sees price
            if (role === 'pro') setText($("ctaPro"), "Go to Pro");
            else setText($("ctaPro"), "Upgrade to Pro ($19/mo)");
          } catch (e) {
            console.warn("Role check failed:", e);
            setText($("ctaPro"), "Go to Pro ($19/mo)");
          }
        });
      } else {
        // No firebase: show neutral CTAs that still work
        show($("ctaBasic"));
        show($("ctaPro"));
        show($("ctaLogin"));
        show($("ctaCreate"));
      }
    })();
  </script>
</body>
</html>

